<!DOCTYPE html>
<html>
<head>
    <title>Video Upload Site</title>
    <style>
        .video-container {
            margin: 20px 0;
        }
        video {
            max-width: 100%;
            max-height: 500px;
        }
    </style>
</head>
<body>
    <h1>Video Upload Site</h1>
    
    <form id="uploadForm">
        <input type="file" name="video" accept="video/*" required>
        <button type="submit">Upload Video</button>
    </form>

    <div id="videoList"></div>

    <script>
        // تحميل قائمة الفيديوهات
        async function loadVideos() {
            const response = await fetch('/videos');
            const videos = await response.json();
            const videoList = document.getElementById('videoList');
            videoList.innerHTML = '';
            
            videos.forEach(video => {
                const container = document.createElement('div');
                container.className = 'video-container';
                
                const videoElement = document.createElement('video');
                videoElement.src = `/uploads/${video}`;
                videoElement.controls = true;
                
                container.appendChild(videoElement);
                videoList.appendChild(container);
            });
        }

        // معالجة نموذج الرفع
        document.getElementById('uploadForm').onsubmit = async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            try {
                await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });
                loadVideos();
                e.target.reset();
            } catch (err) {
                console.error('Upload failed:', err);
            }
        };

        // تحميل الفيديوهات عند بدء التطبيق
        loadVideos();
    </script>
</body>
</html>
